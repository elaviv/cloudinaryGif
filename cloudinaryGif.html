
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" type="text/css" href="cloudinaryGif.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://res.cloudinary.com/demo/raw/upload/jquery.ui.widget_ypnflw.js"></script>
	<script type="text/javascript" src="https://res.cloudinary.com/demo/raw/upload/jquery.iframe-transport_ajzwk5.js"></script>
	<script type="text/javascript" src="https://res.cloudinary.com/demo/raw/upload/jquery.fileupload_adf5kt.js"></script>
	<script type="text/javascript" src="https://res.cloudinary.com/demo/raw/upload/v1425809551/jquery.cloudinary_t0p9km.js"></script>
    
 

<title>Unsigned upload - jQuery and Cloudinary Gif</title>

<script type="text/javascript">
window.onload=function(){

var cloud_name = 'dvlpuh0iw';
var preset_name = 'wjgidlpo';
var _video_sampling = '40';
var _delay = '100';
var _width = 200;

if (cloud_name != '' && preset_name != '') $('#message').remove();

$.cloudinary.config({
  cloud_name: cloud_name
})

$('.upload_field').unsigned_cloudinary_upload(preset_name, {
  cloud_name: cloud_name
}, {
  multiple: true
}).bind('cloudinarydone', function(e, data) {

	//EAVIV: the below line create the URLs dynamically using AJAX, however, it does not work if you run the html from local directory instead of from a  server
	var gifUrl = $.cloudinary.image(data.result.public_id+'.gif', {video_sampling: _video_sampling, delay: _delay, width: _width, effect: "loop", crop: "scale", resource_type: "video"})[0].src;

	gifUrl = 'https://res.cloudinary.com/'+cloud_name+'/video/upload/c_scale,vs_'+_video_sampling+',dl_'+_delay+',e_loop,w_'+_width+'/'+data.result.public_id+'.gif';
	
	$('.gifTitle').text('Animated gif');
	$('.gifUrl').text('Animated gif URL: ' + gifUrl);
	$('.gif').attr('src', gifUrl);
	
  }

).bind('cloudinaryprogress', function(e, data) {
	var percent = Math.round((data.loaded * 100.0) / data.total);
  $('.progress_bar').css('width', percent + '%');
  $('.progress_wrapper .text').text(percent + '%');
});

}//]]> 

</script>

</head>
<body>
<form class="upload_form">
  <input type="file" name="file" class="upload_field">

</form>
<div class="progress_wrapper">
  <div class="progress_bar"><div class="text"></div></div>
  
</div>

<div>
<h1 class="gifTitle"></h1>
<p class="gifUrl"></p>
<img class="gif" ></img>

</div>
  
  <script>
  // tell the embed parent frame the height of the content
  if (window.parent && window.parent.parent){
    window.parent.parent.postMessage(["resultsFrame", {
      height: document.body.getBoundingClientRect().height,
      slug: "None"
    }], "*")
  }
</script>

</body>

</html>

